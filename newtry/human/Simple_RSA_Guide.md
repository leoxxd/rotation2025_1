# ç®€åŒ–ç‰ˆRSAåˆ†æå™¨ä½¿ç”¨æŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

`rsa_analyzer_simple.py` æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„RSAåˆ†æå·¥å…·ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### âœ¨ ä¸»è¦ç‰¹ç‚¹
1. **ç›´æ¥ä½¿ç”¨1000å¼ å›¾ç‰‡**ï¼šä¸åšé‡‡æ ·ï¼Œä½¿ç”¨å…¨éƒ¨å›¾ç‰‡è®¡ç®—RDM
2. **å™ªå£°å¤©èŠ±æ¿æ ¡æ­£**ï¼šåŸºäºfMRIæ•°æ®è®¡ç®—å™ªå£°å¤©èŠ±æ¿
3. **æŒ‰è¢«è¯•å’ŒROIåˆ†å¼€ä¿å­˜**ï¼šç»“æœç»„ç»‡æ¸…æ™°
4. **ä¸°å¯Œçš„å¯è§†åŒ–**ï¼šç”Ÿæˆå¤šç§å›¾è¡¨
5. **ç®€å•ç›´æ¥**ï¼šæ— å¤æ‚çš„é‡‡æ ·é€»è¾‘

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è¿è¡Œåˆ†æ
```bash
cd newtry
python rsa_analyzer_simple.py
```

### 2. è¾“å‡ºç»“æ„
```
rsa_results_simple/
â”œâ”€â”€ rsa_results_simple.mat                    # æ‰€æœ‰ç»“æœï¼ˆMATLABæ ¼å¼ï¼‰
â”œâ”€â”€ rsa_results_simple.csv                    # æ‰€æœ‰ç»“æœï¼ˆCSVæ ¼å¼ï¼‰
â”œâ”€â”€ simple_analysis.txt                       # è¯¦ç»†åˆ†ææŠ¥å‘Š
â”œâ”€â”€ by_subject/                               # æŒ‰è¢«è¯•åˆ†å¼€
â”‚   â”œâ”€â”€ s1_results.mat & s1_results.csv
â”‚   â”œâ”€â”€ s2_results.mat & s2_results.csv
â”‚   â”œâ”€â”€ s5_results.mat & s5_results.csv
â”‚   â””â”€â”€ s7_results.mat & s7_results.csv
â”œâ”€â”€ by_roi/                                   # æŒ‰ROIåˆ†å¼€
â”‚   â”œâ”€â”€ roi_1_results.mat & roi_1_results.csv
â”‚   â”œâ”€â”€ roi_2_results.mat & roi_2_results.csv
â”‚   â””â”€â”€ ...
â””â”€â”€ plots/                                    # å¯è§†åŒ–å›¾è¡¨
    â”œâ”€â”€ correlation_comparison.png            # ç›¸å…³æ€§æ¯”è¾ƒ
    â”œâ”€â”€ roi_comparison.png                    # ROIæ¯”è¾ƒ
    â”œâ”€â”€ subject_comparison.png                # è¢«è¯•æ¯”è¾ƒ
    â”œâ”€â”€ s1_roi_analysis.png                   # s1è¢«è¯•çš„ROIåˆ†æ
    â”œâ”€â”€ s2_roi_analysis.png                   # s2è¢«è¯•çš„ROIåˆ†æ
    â”œâ”€â”€ s5_roi_analysis.png                   # s5è¢«è¯•çš„ROIåˆ†æ
    â””â”€â”€ s7_roi_analysis.png                   # s7è¢«è¯•çš„ROIåˆ†æ
```

## ğŸ“Š åˆ†ææ–¹æ³•

### 1. **ç›´æ¥è®¡ç®—RDM**
- ä½¿ç”¨å…¨éƒ¨1000å¼ å›¾ç‰‡è®¡ç®—embedding RDM
- ä½¿ç”¨å…¨éƒ¨1000å¼ å›¾ç‰‡è®¡ç®—ROI RDM
- ç›´æ¥è®¡ç®—ä¸¤ä¸ªRDMçš„ç›¸å…³æ€§

### 2. **å™ªå£°å¤©èŠ±æ¿æ ¡æ­£**
```python
# å™ªå£°å¤©èŠ±æ¿ = è¯¥è¢«è¯•fMRI RDMä¸å…¶ä»–è¢«è¯•å¹³å‡fMRI RDMçš„ç›¸å…³æ€§
noise_ceiling = corr_rdms(subject_rdm, mean_other_subjects_rdm)

# æ ¡æ­£åç›¸å…³æ€§
corrected_correlation = raw_correlation / noise_ceiling
```

### 3. **ä¸ä¼ ç»Ÿæ–¹æ³•å¯¹æ¯”**
- åŒæ—¶è®¡ç®—Spearmanç›¸å…³æ€§ä½œä¸ºå¯¹æ¯”
- æä¾›å¤šç§ç›¸å…³æ€§æŒ‡æ ‡

## ğŸ” ç»“æœè§£è¯»

### 1. **åŸå§‹ç›¸å…³æ€§**
- ç›´æ¥è®¡ç®—çš„ç›¸å…³æ€§ï¼ˆæ— æ ¡æ­£ï¼‰
- é€šå¸¸è¾ƒä½ï¼ˆ0.1-0.3ï¼‰

### 2. **æ ¡æ­£åç›¸å…³æ€§**
- å™ªå£°å¤©èŠ±æ¿æ ¡æ­£åçš„ç›¸å…³æ€§
- å¯èƒ½ > 1.0ï¼ˆè¡¨ç¤ºè¶…è¿‡å™ªå£°å¤©èŠ±æ¿ï¼‰
- é€šå¸¸æ›´é«˜ï¼ˆ0.3-0.5ï¼‰

### 3. **å™ªå£°å¤©èŠ±æ¿**
- è¯¥ROIåœ¨è¯¥è¢«è¯•ä¸­çš„æœ€å¤§å¯èƒ½ç›¸å…³æ€§
- é€šå¸¸åœ¨0.3-0.8ä¹‹é—´

## ğŸ“ˆ å¯è§†åŒ–å›¾è¡¨

### 1. **ç›¸å…³æ€§æ¯”è¾ƒå›¾**
- åŸå§‹ vs æ ¡æ­£åç›¸å…³æ€§çš„æ•£ç‚¹å›¾
- æ˜¾ç¤ºæ ¡æ­£æ•ˆæœ

### 2. **ROIæ¯”è¾ƒå›¾**
- æŒ‰è„‘åŒºåˆ†ç»„çš„ç®±çº¿å›¾
- æ¯”è¾ƒä¸åŒè„‘åŒºçš„è¡¨ç°

### 3. **è¢«è¯•æ¯”è¾ƒå›¾**
- æŒ‰è¢«è¯•åˆ†ç»„çš„ç®±çº¿å›¾
- æ¯”è¾ƒä¸åŒè¢«è¯•çš„è¡¨ç°

### 4. **ä¸ªåˆ«è¢«è¯•ROIåˆ†æå›¾**
- æ¯ä¸ªè¢«è¯•çš„è¯¦ç»†ROIåˆ†æ
- 4ä¸ªå­å›¾ï¼šåŸå§‹ç›¸å…³æ€§ã€æ ¡æ­£åç›¸å…³æ€§ã€å™ªå£°å¤©èŠ±æ¿ã€æ ¡æ­£æ•ˆæœ

## ğŸ¯ ä¼˜åŠ¿

### 1. **ç®€å•ç›´æ¥**
- æ— å¤æ‚é‡‡æ ·é€»è¾‘
- ä½¿ç”¨å…¨éƒ¨æ•°æ®
- è®¡ç®—é€Ÿåº¦å¿«

### 2. **ç»“æœç¨³å®š**
- æ— éšæœºé‡‡æ ·å½±å“
- ç»“æœå¯é‡å¤
- æ•°æ®åˆ©ç”¨ç‡é«˜

### 3. **æ˜“äºç†è§£**
- é€»è¾‘æ¸…æ™°
- ç»“æœç›´è§‚
- ä¾¿äºè§£é‡Š

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. **è®¡ç®—èµ„æº**
- ä½¿ç”¨å…¨éƒ¨1000å¼ å›¾ç‰‡
- å†…å­˜éœ€æ±‚è¾ƒé«˜
- è®¡ç®—æ—¶é—´è¾ƒé•¿

### 2. **ç»“æœè§£é‡Š**
- æ ¡æ­£åç›¸å…³æ€§å¯èƒ½ > 1.0
- è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œè¡¨ç¤ºè¶…è¿‡å™ªå£°å¤©èŠ±æ¿
- ä¸éœ€è¦äººä¸ºé™åˆ¶

### 3. **æ•°æ®è´¨é‡**
- éœ€è¦ç¡®ä¿ROIå’Œembeddingæ•°æ®è´¨é‡
- å™ªå£°å¤©èŠ±æ¿è¿‡ä½å¯èƒ½è¡¨æ˜æ•°æ®é—®é¢˜

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### 1. **ç›¸å…³æ€§è®¡ç®—**
```python
def corr_rdms(X, Y):
    """åŸå§‹é¡¹ç›®çš„ç›¸å…³æ€§è®¡ç®—å‡½æ•°"""
    X = X - X.mean(axis=1, keepdims=True)
    X /= np.sqrt(np.einsum("ij,ij->i", X, X))[:, None]
    Y = Y - Y.mean(axis=1, keepdims=True)
    Y /= np.sqrt(np.einsum("ij,ij->i", Y, Y))[:, None]
    return np.einsum("ik,jk", X, Y)
```

### 2. **RDMè®¡ç®—**
```python
# embedding RDM
embedding_rdm = pdist(embeddings, metric='correlation')

# ROI RDM (ä».matæ–‡ä»¶åŠ è½½)
roi_rdm = roi_info['rdm'][0, 0].flatten()
```

### 3. **å™ªå£°å¤©èŠ±æ¿è®¡ç®—**
```python
# è¯¥è¢«è¯•çš„fMRI RDM
subject_rdm = all_subject_rdms[subject][roi_key]

# å…¶ä»–è¢«è¯•çš„å¹³å‡fMRI RDM
other_subjects = [s for s in subjects if s != subject]
other_rdms = [all_subject_rdms[s][roi_key] for s in other_subjects]
mean_other_rdm = np.mean(other_rdms, axis=0)

# å™ªå£°å¤©èŠ±æ¿
noise_ceiling = corr_rdms(subject_rdm.reshape(1, -1), mean_other_rdm.reshape(1, -1))[0, 0]
```

## ğŸ‰ é¢„æœŸæ•ˆæœ

ä½¿ç”¨ç®€åŒ–ç‰ˆåˆ†æå™¨ï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°ï¼š

1. **æ›´ç¨³å®šçš„ç»“æœ**ï¼šæ— é‡‡æ ·éšæœºæ€§
2. **æ›´é«˜çš„ç›¸å…³æ€§**ï¼šä½¿ç”¨å…¨éƒ¨æ•°æ®
3. **æ›´å¿«çš„è®¡ç®—**ï¼šæ— å¤æ‚é‡‡æ ·é€»è¾‘
4. **æ›´æ¸…æ™°çš„ç»“æœ**ï¼šç›´æ¥ä½¿ç”¨1000å¼ å›¾ç‰‡

è¿™ä¸ªç‰ˆæœ¬æ›´é€‚åˆå¿«é€ŸéªŒè¯å’Œåˆæ­¥åˆ†æï¼ğŸš€

